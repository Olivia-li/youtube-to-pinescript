//@version=4
strategy("RSI Adaptive and Fischer Transform Trading Strategy", overlay=true)

//RSI Adaptive indicator
len = input(title="Length", type=input.integer, defval=14, minval=1)
src = input(title="Source", type=input.source, defval=close)
RSI = rma(rsi(src, len), len)
alpha = input(title="Alpha", type=input.float, defval=0.07, minval=0.01, maxval=1)
beta = input(title="Beta", type=input.float, defval=0.07, minval=0.01, maxval=1)
gamma = input(title="Gamma", type=input.float, defval=0.07, minval=0.01, maxval=1)
delta = input(title="Delta", type=input.float, defval=0.07, minval=0.01, maxval=1)
RSI_Adaptive = alpha * RSI + beta * rma(RSI, 2) + gamma * rma(RSI, 3) + delta * rma(RSI, 4)

//Adaptive Fischer Transform with D-Zones and Divs
len1 = input(title="Length", type=input.integer, defval=10, minval=1)
len2 = input(title="Length 2", type=input.integer, defval=5, minval=1)
src1 = input(title="Source", type=input.source, defval=close)
src2 = input(title="Source 2", type=input.source, defval=volume)
Fisher = fishertransform(src1, len1)
FisherSignal = sma(Fisher, len2)
FisherDiv = Fisher - FisherSignal
FisherDivUp = FisherDiv > 0 ? FisherDiv : 0
FisherDivDown = FisherDiv < 0 ? FisherDiv : 0
FisherDZone = 0.5

//GKYz Filtered Indicator
len3 = input(title="Length 3", type=input.integer, defval=3, minval=1)
len4 = input(title="Length 4", type=input.integer, defval=10, minval=1)
src3 = input(title="Source 3", type=input.source, defval=close)
src4 = input(title="Source 4", type=input.source, defval=high)
src5 = input(title="Source 5", type=input.source, defval=low)
GKYz = (src3 - ema(src3, len3)) * 100 / atr(len3)
GKYzFiltered = ema(GKYz, len4)

//Buy signal
buySignal = crossover(GKYzFiltered, 0) and Fisher > FisherSignal and close > open

//Sell signal
sellSignal = crossunder(GKYzFiltered, 0) and Fisher < FisherSignal and close < open

//Stop loss
stopLoss = buySignal ? low[1] : high[1]

//Risk to reward ratio
takeProfit = buySignal ? close + (close - stopLoss) * 1.5 : close - (stopLoss - close) * 1.5

//Trade entry and exit
if (buySignal)
    strategy.entry("Buy", strategy.long)
    strategy.exit("Exit", "Buy", stop=stopLoss, limit=takeProfit)
if (sellSignal)
    strategy.entry("Sell", strategy.short)
    strategy.exit("Exit", "Sell", stop=stopLoss, limit=takeProfit)

//Plotting indicators
plot(RSI_Adaptive, color=color.blue, title="RSI Adaptive")
plot(Fisher, color=Fisher > FisherSignal ? color.green : color.red, title="Fisher Transform")
plot(FisherSignal, color=color.black, title="Fisher Signal")
plot(FisherDivUp, color=color.green, title="Fisher Div Up")
plot(FisherDivDown, color=color.red, title="Fisher Div Down")
plot(FisherDZone, color=color.orange, title="Fisher D Zone")
plot(GKYzFiltered, color=color.purple, title="GKYz Filtered")