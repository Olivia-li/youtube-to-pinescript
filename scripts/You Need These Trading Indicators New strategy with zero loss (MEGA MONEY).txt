//@version=4
strategy("Trader XO Micro Trend Scanner Strategy", overlay=true)

// Trader XO Micro Trend Scanner
fastMA = input(title="Fast MA", type=input.integer, defval=10)
slowMA = input(title="Slow MA", type=input.integer, defval=20)
source = input(title="Source", type=input.source, defval=close)
maFast = sma(source, fastMA)
maSlow = sma(source, slowMA)
longSignal = crossover(maFast, maSlow)
shortSignal = crossunder(maFast, maSlow)

// MACD
fastEMA = input(title="Fast EMA", type=input.integer, defval=12)
slowEMA = input(title="Slow EMA", type=input.integer, defval=26)
signalEMA = input(title="Signal EMA", type=input.integer, defval=9)
macdLine = ema(close, fastEMA) - ema(close, slowEMA)
signalLine = ema(macdLine, signalEMA)
histogram = macdLine - signalLine

// Moving Average Exponential
ema200 = ema(close, 200)

// Entry and Exit Conditions
enterLong = longSignal and histogram > 0 and close > ema200
enterShort = shortSignal and histogram < 0 and close < ema200
exitLong = shortSignal
exitShort = longSignal

// Plotting
plot(maFast, color=color.blue, title="Fast MA")
plot(maSlow, color=color.red, title="Slow MA")
plot(ema200, color=color.black, title="EMA 200")
plot(histogram, color=histogram > histogram[1] ? color.green : color.red, title="MACD Histogram")

// Strategy Execution
if (enterLong)
    strategy.entry("Long", strategy.long)
if (enterShort)
    strategy.entry("Short", strategy.short)
if (exitLong)
    strategy.close("Long")
if (exitShort)
    strategy.close("Short")